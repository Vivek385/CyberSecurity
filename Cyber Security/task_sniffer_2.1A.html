<pre><font color="#00FFAF"> </font><font color="#00FF87">         </font><font color="#5FFF87"> </font><font color="#5FFF5F">  ____   __</font><font color="#87FF5F">_</font><font color="#87FF00"> ____  __</font><font color="#AFFF00">___       </font><font color="#AFD700"> </font><font color="#D7D700">   _   _ __</font><font color="#D7AF00">_</font><font color="#FFAF00">_  _ _ __</font><font color="#FF8700">__  </font>
<font color="#00FF87">       </font><font color="#5FFF87"> </font><font color="#5FFF5F">    |___ \ </font><font color="#87FF5F">/</font><font color="#87FF00"> _ \___ \</font><font color="#AFFF00">|___ / _ _</font><font color="#AFD700">_</font><font color="#D7D700"> ___ | |_/ </font><font color="#D7AF00">|</font><font color="#FFAF00">___ \/ / </font><font color="#FF8700">| ___| </font>
<font color="#00FF87">    </font><font color="#5FFF87"> </font><font color="#5FFF5F">         __</font><font color="#87FF5F">)</font><font color="#87FF00"> | | | |_</font><font color="#AFFF00">_) | |_ \|</font><font color="#AFD700"> </font><font color="#D7D700">&apos;_ ` _ \| _</font><font color="#D7AF00">_</font><font color="#FFAF00">| | __) |</font><font color="#FF8700"> | |___ \</font><font color="#FF875F"> </font>
<font color="#00FF87"> </font><font color="#5FFF87"> </font><font color="#5FFF5F">           </font><font color="#87FF5F">/</font><font color="#87FF00"> __/| |_|</font><font color="#AFFF00"> / __/ ___</font><font color="#AFD700">)</font><font color="#D7D700"> | | | | | </font><font color="#D7AF00">|</font><font color="#FFAF00"> |_| |/ _</font><font color="#FF8700">_/| | |__</font><font color="#FF875F">_</font><font color="#FF5F5F">) |</font>
<font color="#5FFF5F">          </font><font color="#87FF5F"> </font><font color="#87FF00"> |_____|\</font><font color="#AFFF00">___/_____|</font><font color="#AFD700">_</font><font color="#D7D700">___/|_| |_|</font><font color="#D7AF00"> </font><font color="#FFAF00">|_|\__|_|</font><font color="#FF8700">_____|_|_</font><font color="#FF875F">|</font><font color="#FF5F5F">____/ </font>
<font color="#5FFF5F">       </font><font color="#87FF5F"> </font><font color="#87FF00">         </font><font color="#AFFF00">          </font><font color="#AFD700"> </font><font color="#D7D700">           </font><font color="#D7AF00"> </font><font color="#FFAF00">         </font><font color="#FF8700">         </font><font color="#FF875F"> </font><font color="#FF5F5F">         </font>
<font color="#5FFF5F">         </font><font color="#87FF5F"> </font><font color="#87FF00">         </font><font color="#AFFF00">      +-+-</font><font color="#AFD700">+</font><font color="#D7D700">-+-+-+ +-+-</font><font color="#D7AF00">+</font><font color="#FFAF00">-+-+-+-+-</font><font color="#FF8700">+-+</font>
<font color="#5FFF5F">      </font><font color="#87FF5F"> </font><font color="#87FF00">         </font><font color="#AFFF00">         |</font><font color="#AFD700">V</font><font color="#D7D700">|i|v|e|k| |</font><font color="#D7AF00">K</font><font color="#FFAF00">|u|l|k|a|</font><font color="#FF8700">r|n|i|</font>
<font color="#5FFF5F">   </font><font color="#87FF5F"> </font><font color="#87FF00">         </font><font color="#AFFF00">          </font><font color="#AFD700"> </font><font color="#D7D700"> +-+-+-+-+-</font><font color="#D7AF00">+</font><font color="#FFAF00"> +-+-+-+-</font><font color="#FF8700">+-+-+-+-+</font>
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ docker ps
CONTAINER ID   IMAGE                               COMMAND                  CREATED       STATUS          PORTS     NAMES
e6441e54c7f2   handsonsecurity/seed-ubuntu:large   &quot;/bin/sh -c /bin/bash&quot;   3 hours ago   Up 13 minutes             seed-attacker
250c3f1966b5   handsonsecurity/seed-ubuntu:large   &quot;bash -c &apos; /etc/init…&quot;   3 hours ago   Up 13 minutes             hostA-10.9.0.5
d0318ad0559a   handsonsecurity/seed-ubuntu:large   &quot;bash -c &apos; /etc/init…&quot;   3 hours ago   Up 13 minutes             hostB-10.9.0.6
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ vi sniffer.c
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ gcc sniffer.c -lpcap
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ docker cp a.out e6441e54c7f2
must specify at least one container source
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ docker cp a.out e6441e54c7f2:/tmp
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ docksh e6
root@VM:/# ls
bin   dev  home  lib32	libx32	mnt  proc  run	 srv  tmp  var
boot  etc  lib	 lib64	media	opt  root  sbin  sys  usr  volumes
root@VM:/# cd tmp
root@VM:/tmp# ./a.out
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
Got a packet
^C
root@VM:/tmp# ls     
a.out
root@VM:/tmp# ./a.out
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
       From: 10.0.2.4
         To: 8.8.8.8
   Protocol: ICMP
       From: 8.8.8.8
         To: 10.0.2.4
   Protocol: ICMP
^C
root@VM:/tmp# ip -d link show dev br-6438effbf2d7
3: br-6438effbf2d7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether 02:42:f5:4b:23:29 brd ff:ff:ff:ff:ff:ff promiscuity 0 minmtu 68 maxmtu 65535 
    bridge forward_delay 1500 hello_time 200 max_age 2000 ageing_time 30000 stp_state 0 priority 32768 vlan_filtering 0 vlan_protocol 802.1Q bridge_id 8000.2:42:f5:4b:23:29 designated_root 8000.2:42:f5:4b:23:29 root_port 0 root_path_cost 0 topology_change 0 topology_change_detected 0 hello_timer    0.00 tcn_timer    0.00 topology_change_timer    0.00 gc_timer   74.62 vlan_default_pvid 1 vlan_stats_enabled 0 vlan_stats_per_port 0 group_fwd_mask 0 group_address 01:80:c2:00:00:00 mcast_snooping 1 mcast_router 1 mcast_query_use_ifaddr 0 mcast_querier 0 mcast_hash_elasticity 16 mcast_hash_max 4096 mcast_last_member_count 2 mcast_startup_query_count 2 mcast_last_member_interval 100 mcast_membership_interval 26000 mcast_querier_interval 25500 mcast_query_interval 12500 mcast_query_response_interval 1000 mcast_startup_query_interval 3124 mcast_stats_enabled 0 mcast_igmp_version 2 mcast_mld_version 1 nf_call_iptables 0 nf_call_ip6tables 0 nf_call_arptables 0 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
root@VM:/tmp# ./a.out
Got one packet
Got one packet
Got one packet
Got one packet
Got one packet
Got one packet
Got one packet
Got one packet
Got one packet
^C
root@VM:/tmp# ip -d link show dev br-6438effbf2d7
3: br-6438effbf2d7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether 02:42:f5:4b:23:29 brd ff:ff:ff:ff:ff:ff promiscuity 0 minmtu 68 maxmtu 65535 
    bridge forward_delay 1500 hello_time 200 max_age 2000 ageing_time 30000 stp_state 0 priority 32768 vlan_filtering 0 vlan_protocol 802.1Q bridge_id 8000.2:42:f5:4b:23:29 designated_root 8000.2:42:f5:4b:23:29 root_port 0 root_path_cost 0 topology_change 0 topology_change_detected 0 hello_timer    0.00 tcn_timer    0.00 topology_change_timer    0.00 gc_timer  177.43 vlan_default_pvid 1 vlan_stats_enabled 0 vlan_stats_per_port 0 group_fwd_mask 0 group_address 01:80:c2:00:00:00 mcast_snooping 1 mcast_router 1 mcast_query_use_ifaddr 0 mcast_querier 0 mcast_hash_elasticity 16 mcast_hash_max 4096 mcast_last_member_count 2 mcast_startup_query_count 2 mcast_last_member_interval 100 mcast_membership_interval 26000 mcast_querier_interval 25500 mcast_query_interval 12500 mcast_query_response_interval 1000 mcast_startup_query_interval 3124 mcast_stats_enabled 0 mcast_igmp_version 2 mcast_mld_version 1 nf_call_iptables 0 nf_call_ip6tables 0 nf_call_arptables 0 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
root@VM:/tmp# ./a.out
Got one packet
Got one packet
Got one packet
Got one packet
^C
root@VM:/tmp# ip -d link show dev br-6438effbf2d7
3: br-6438effbf2d7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether 02:42:f5:4b:23:29 brd ff:ff:ff:ff:ff:ff promiscuity 0 minmtu 68 maxmtu 65535 
    bridge forward_delay 1500 hello_time 200 max_age 2000 ageing_time 30000 stp_state 0 priority 32768 vlan_filtering 0 vlan_protocol 802.1Q bridge_id 8000.2:42:f5:4b:23:29 designated_root 8000.2:42:f5:4b:23:29 root_port 0 root_path_cost 0 topology_change 0 topology_change_detected 0 hello_timer    0.00 tcn_timer    0.00 topology_change_timer    0.00 gc_timer  223.91 vlan_default_pvid 1 vlan_stats_enabled 0 vlan_stats_per_port 0 group_fwd_mask 0 group_address 01:80:c2:00:00:00 mcast_snooping 1 mcast_router 1 mcast_query_use_ifaddr 0 mcast_querier 0 mcast_hash_elasticity 16 mcast_hash_max 4096 mcast_last_member_count 2 mcast_startup_query_count 2 mcast_last_member_interval 100 mcast_membership_interval 26000 mcast_querier_interval 25500 mcast_query_interval 12500 mcast_query_response_interval 1000 mcast_startup_query_interval 3124 mcast_stats_enabled 0 mcast_igmp_version 2 mcast_mld_version 1 nf_call_iptables 0 nf_call_ip6tables 0 nf_call_arptables 0 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
root@VM:/tmp# ./a.out
       From: 10.0.2.4
         To: 34.107.221.82
   Protocol: TCP
       From: 10.0.2.4
         To: 34.107.221.82
   Protocol: TCP
       From: 34.107.221.82
         To: 10.0.2.4
   Protocol: TCP
       From: 34.107.221.82
         To: 10.0.2.4
   Protocol: TCP
       From: 10.0.2.4
         To: 185.199.111.133
   Protocol: TCP
       From: 185.199.111.133
         To: 10.0.2.4
   Protocol: TCP
       From: 10.0.2.4
         To: 185.199.111.133
   Protocol: TCP
^C
root@VM:/tmp# sudo tcpdump -i br-6438effbf2d7 -n -p
bash: sudo: command not found
root@VM:/tmp# tcpdump -i br-6438effbf2d7 -n -p
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on br-6438effbf2d7, link-type EN10MB (Ethernet), capture size 262144 bytes
^C
0 packets captured
0 packets received by filter
0 packets dropped by kernel
root@VM:/tmp# tcpdump -i br-6438effbf2d7 -p
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on br-6438effbf2d7, link-type EN10MB (Ethernet), capture size 262144 bytes
16:36:16.112906 ARP, Request who-has VM tell 10.9.0.6, length 28
16:36:16.112943 ARP, Reply VM is-at 02:42:f5:4b:23:29 (oui Unknown), length 28
16:36:16.112950 IP 10.9.0.6 &gt; dns.google: ICMP echo request, id 5, seq 1, length 64
16:36:16.132241 IP dns.google &gt; 10.9.0.6: ICMP echo reply, id 5, seq 1, length 64
16:36:17.117256 IP 10.9.0.6 &gt; dns.google: ICMP echo request, id 5, seq 2, length 64
16:36:17.151975 IP dns.google &gt; 10.9.0.6: ICMP echo reply, id 5, seq 2, length 64
16:36:18.121439 IP 10.9.0.6 &gt; dns.google: ICMP echo request, id 5, seq 3, length 64
16:36:18.141856 IP dns.google &gt; 10.9.0.6: ICMP echo reply, id 5, seq 3, length 64
16:36:19.123157 IP 10.9.0.6 &gt; dns.google: ICMP echo request, id 5, seq 4, length 64
16:36:19.153146 IP dns.google &gt; 10.9.0.6: ICMP echo reply, id 5, seq 4, length 64
16:36:21.323229 ARP, Request who-has 10.9.0.6 tell VM, length 28
16:36:21.323264 ARP, Reply 10.9.0.6 is-at 02:42:0a:09:00:06 (oui Unknown), length 28
^C
12 packets captured
12 packets received by filter
0 packets dropped by kernel
root@VM:/tmp# ifconfig
br-6438effbf2d7: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.9.0.1  netmask 255.255.255.0  broadcast 10.9.0.255
        inet6 fe80::42:f5ff:fe4b:2329  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 02:42:f5:4b:23:29  txqueuelen 0  (Ethernet)
        RX packets 6  bytes 392 (392.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 41  bytes 5120 (5.1 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:d4:56:3f:79  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255
        inet6 fe80::5fb6:874b:acd2:768c  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 08:00:27:0e:cd:fe  txqueuelen 1000  (Ethernet)
        RX packets 8869  bytes 8705452 (8.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 7164  bytes 1109569 (1.1 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 1601  bytes 152769 (152.7 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1601  bytes 152769 (152.7 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth499c73f: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet6 fe80::4c13:5ff:fe59:ccec  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 4e:13:05:59:cc:ec  txqueuelen 0  (Ethernet)
        RX packets 6  bytes 476 (476.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 75  bytes 8852 (8.8 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth8c98444: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet6 fe80::78bd:1bff:fe40:67bd  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 7a:bd:1b:40:67:bd  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 71  bytes 8528 (8.5 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

root@VM:/tmp# exit
exit
[09/12/23]<font color="#4E9A06"><b>seed@VM</b></font>:<font color="#3465A4"><b>~/.../Sniffing_Spoofing</b></font>$ 
</pre>
